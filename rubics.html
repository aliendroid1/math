<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matrix Rotations</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .matrix-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        table {
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
            width: 30px;
            height: 30px;
        }
        .button-container {
            margin-top: 16px;
        }
    </style>
</head>
<body>
    <div class="matrix-container">
        <table>
            <tbody id="static-matrix">
            </tbody>
        </table>
        <table id="dynamic-table">
            <tbody id="matrix">
            </tbody>
        </table>
    </div>
    <div class="button-container">
        <button onclick="randomizeMatrix()">Randomize</button>
        <button onclick="resetMatrix()">Reset</button>
    </div>

   <script>
        const initialMatrixData = [
            [0, 0, 1],
            [0, 1, 0],
            [0, 1, 1],
            [1, 0, 0],
            [1, 0, 1],
            [1, 1, 0],
            [1, 1, 1]
        ];

        let matrixData = JSON.parse(JSON.stringify(initialMatrixData));

        const matrixElement = document.getElementById("matrix");
        const staticMatrixElement = document.getElementById("static-matrix");
        const dynamicTableElement = document.getElementById("dynamic-table");

        const colors = ['red', 'green', 'blue'];

        function renderMatrix(matrix, element) {
            element.innerHTML = matrix.map((row, rowIndex) => {
                return `<tr>${row.map((cell, columnIndex) => {
                    const backgroundColor = cell === 1 ? colors[columnIndex] : 'transparent';
                    return `<td style="background-color: ${backgroundColor};" data-column="${columnIndex}"></td>`;
                }).join("")}</tr>`;
            }).join("");
        }

                function rotateColumn(column, down) {
            const rowsToRotate = [];
            for (let rowIndex = 0; rowIndex < matrixData.length; rowIndex++) {
                if (matrixData[rowIndex][column] === 1) {
                    rowsToRotate.push(rowIndex);
                }
            }

            if (down) {
                const lastRow = matrixData[rowsToRotate[rowsToRotate.length - 1]];
                for (let i = rowsToRotate.length - 1; i > 0; i--) {
                    matrixData[rowsToRotate[i]] = matrixData[rowsToRotate[i - 1]];
                }
                matrixData[rowsToRotate[0]] = lastRow;
            } else {
                const firstRow = matrixData[rowsToRotate[0]];
                for (let i = 0; i < rowsToRotate.length - 1; i++) {
                    matrixData[rowsToRotate[i]] = matrixData[rowsToRotate[i + 1]];
                }
                matrixData[rowsToRotate[rowsToRotate.length - 1]] = firstRow;
            }

            renderMatrix(matrixData, matrixElement);
        }

        function randomizeMatrix() {
            const numberOfRandomOperations = 20;
            for (let i = 0; i < numberOfRandomOperations; i++) {
                const randomColumn = Math.floor(Math.random() * 3);
                const down = Math.random() >= 0.5;
                rotateColumn(randomColumn, down);
            }
        }

        function resetMatrix() {
            matrixData = JSON.parse(JSON.stringify(initialMatrixData));
            renderMatrix(matrixData, matrixElement);
        }

        function handleTouchStart(e) {
            e.preventDefault();
            e.stopPropagation();
            touchStartY = e.touches[0].clientY;
        }

        function handleTouchMove(e) {
            e.preventDefault();
            e.stopPropagation();
            touchEndY = e.touches[0].clientY;
        }

        function handleTouchEnd(e) {
            const column = e.target.getAttribute("data-column");
            if (column !== null && touchStartY && touchEndY) {
                const down = touchEndY - touchStartY > 0;
                rotateColumn(parseInt(column), down);
            }
        }

        renderMatrix(matrixData, matrixElement);
        renderMatrix(initialMatrixData, staticMatrixElement);

        let touchStartY;
        let touchEndY;

        dynamicTableElement.addEventListener("touchstart", handleTouchStart);
        dynamicTableElement.addEventListener("touchmove", handleTouchMove);
        dynamicTableElement.addEventListener("touchend", handleTouchEnd);
</script> 
</body> 
</html>